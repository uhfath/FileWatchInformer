### Конфигурирование

#### `Email`

| *поля со звёздочкой обязательные*

| Параметр | Описание | Значение по умолчанию |
|----------|----------|-----------------------|
| **`Server`** * | Адрес SMTP сервера. |  |
| `Port` | Номер используемого SMTP порта. | 587 |
| `Security` | Настройка шифрования: <ul><li>`Auto` - автоматический режим определения;</li><li>`None` - не использовать SSL/TLS шифрование;</li><li>`SslOnConnect` - использовать SSL/TLS;</li><li>`StartTls` - использовать только TLS. Если сервер не поддерживает `STARTTLS`, будет ошибка;</li><li>`StartTlsWhenAvailable` - использовать TLS, только если сервер поддерживает `STARTTLS`.</li></ul> | `Auto` |
| **`Login`** * | Имя пользователя для подключения к SMTP. |  |
| **`Password`** * | Пароль для подключения к SMTP. |  |
| **`From`** * | Поле "от кого" в создаваемом сообщении. |  |
| `DefaultSubject` | Тема сообщения по умолчанию, если не переопределено в индивидуальных параметрах каждого пользователя. | "Информирование о наличии невостребованных файлов" |
| `DefaultBody` | Текст сообщения по умолчанию, если не переопределено в индивидуальных параметрах каждого пользователя. | "Список файлов, которые необходимо обработать\r\n%FILELIST%" |

#### `Watcher`

| *поля со звёздочкой обязательные*

| Параметр | Описание | Значение по умолчанию |
|----------|----------|-----------------------|
| **`Folder`** * | Путь к папке мониторинга. |  |
| `Interval` | Интервал проверки папки `Folder`. Формат `hh:mm:ss`, где `hh` - часы, `mm` - минуты, `ss` - секунды. |  |
| `Delay` | Задержка между отправкой сообщений. Формат `hh:mm:ss`, где `hh` - часы, `mm` - минуты, `ss` - секунды. |  |
| `DefaultIncludeMask` | Маска отбора файлов по умолчанию, если не переопределено в индивидуальных параметрах каждого пользователя. |  |
| `DefaultExcludeMask` | Маска исключения файлов по умолчанию, если не переопределено в индивидуальных параметрах каждого пользователя. |  |

Если `Interval` установлен, то через указанные интервалы будет проводиться проверка содержимого папки `Folder`.
Если внутри будут обнаружены файлы, исключённые по одной маске (`DefaultExcludeMask` или `ExcludeMask`) и подходящие по другой (`DefaultIncludeMask` или `IncludeMask`), то в соответствии с именем корневой папки из `Users` будет получен адресат (`Address`), которого необходимо проинформировать с темой (`DefaultSubject` или `Subject`) и текстом (`DefaultBody` или `Body`).

Если `Interval` не задан, то проверка будет произведена один раз при запуске сервиса, а затем сервис будет остановлен. Удобно в случае, если нужно контролировать интервалы внешними средствами (например, планировщик вашей ОС).

Если `Delay` установлен, то указанная задержка будет использоваться между отправкой каждого сообщения пользователю. Удобно в случае, если почтовый сервер не допускает слишком частой отправки писем.

#### `Users`

Состоит из пар "ключ" - "параметры"

| Параметр | Описание | Значение по умолчанию |
|----------|----------|-----------------------|
| "ключ" | Имя подпапки внутри `Folder` (на первом уровне). |  |
|

#### Макросы для текста сообщения

Можно использовать следующие макросы для подстановки в текст сообщения:
* `%FILELIST%` - заменяется на список файлов, обнаруженных сервисом.
